apply plugin: 'com.android.library'
apply plugin: 'kotlin-android'
apply plugin: 'kotlin-kapt'
apply plugin: 'kotlin-android-extensions'

android {
    compileSdkVersion rootProject.ext.compileSdkVersion
    buildToolsVersion rootProject.ext.buildToolsVersion
    defaultConfig {
        minSdkVersion rootProject.ext.minSdkVersion
        targetSdkVersion rootProject.ext.targetSdkVersion
        versionCode rootProject.ext.versionCode
        versionName rootProject.ext.versionName

        testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"

    }
    sourceSets {
        if (project.hasProperty("srcDirs")) {
            main {
                java.excludes = [
                        '**/build/**',
                ]
                project.ext.srcDirs.forEach {
                    assets.srcDirs += "$projectDir/$it/main/assets"
                    aidl.srcDirs += "$projectDir/$it/main/aidl"
                    res.srcDirs += "$projectDir/$it/main/res-frame-animation"
                    res.srcDirs += "$projectDir/$it/main/res"
                    java.srcDirs += "$projectDir/$it/main/java"

//                    assets.srcDirs += "$projectDir/src/inhouse/assets"
//                    aidl.srcDirs += "$projectDir/src/inhouse/aidl"
//                    res.srcDirs += "$projectDir/src/inhouse/res"
//                    java.srcDirs += "$projectDir/src/inhouse/java"
                }
            }
            androidTest {
                project.ext.srcDirs.forEach {
                    assets.srcDirs += "$projectDir/$it/androidTest/assets"
                    aidl.srcDirs += "$projectDir/$it/androidTest/aidl"
                    res.srcDirs += "$projectDir/$it/androidTest/res"
                    java.srcDirs += "$projectDir/$it/androidTest/java"

                }
            }
            test {
                project.ext.srcDirs.forEach {
                    java.srcDirs += "$projectDir/$it/test/java"
                }

            }
        }
    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }

//        inhouse {
//            initWith debug
//            debuggable true
//        }
    }

    kotlinOptions {
        jvmTarget = "1.8"
    }

}
dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar'])
    implementation project(path: ':framework:common')
}

//class ExtSourceSetsPlugin implements Plugin<Project> {
//
//    @Override
//    void apply(Project project) {
//        def srcDirs = project.extensions.create("SourcesExtension", SourcesExtension)
//        project.beforeEvaluate {
//
//
//        }
//    }
//}
//
//class SourcesExtension {
//    List<String> srcDirs
//}
//apply plugin: ExtSourceSetsPlugin
